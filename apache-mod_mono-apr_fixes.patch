--- mod_mono-1.0.4/configure.in~ 2004-10-29 19:58:03.000000000 +0000
+++ mod_mono-1.0.4/configure.in	2004-11-20 00:36:32.000000000 +0000
@@ -371,7 +371,7 @@
 AC_MSG_RESULT($DFLT_MONO_CONFIG_DIR))

 found_apr_socket_connect=no
-AC_CHECK_LIB(apr-0, apr_socket_connect, found_apr_socket_connect=yes)
+AC_CHECK_LIB(apr-1, apr_socket_connect, found_apr_socket_connect=yes)
 if test "x$found_apr_socket_connect" = "xyes" ; then
        AC_DEFINE([HAVE_APR_SOCKET_CONNECT],,[apr_socket_connect is present])
 fi
--- mod_mono-1.0.4/src/mod_mono.c~	2004-10-29 19:58:03.000000000 +0000
+++ mod_mono-1.0.4/src/mod_mono.c	2004-11-20 00:18:59.000000000 +0000
@@ -117,9 +117,7 @@
 #ifdef APACHE13
 	return  ntohs (c->remote_addr.sin_port);
 #else
-	apr_port_t port;
-	apr_sockaddr_port_get (&port, c->remote_addr);
-	return port;
+	return c->remote_addr->port;
 #endif
   
 }
@@ -130,9 +128,7 @@
 #ifdef APACHE13  
 	return ap_get_server_port (r);
 #else
-	apr_port_t port;
-	apr_sockaddr_port_get (&port, r->connection->local_addr);
-	return port;  
+	return r->connection->local_addr->port;
 #endif
 }
 
@@ -779,7 +779,7 @@
 
 	family = (server_conf->listen_port != NULL) ? PF_INET : PF_UNIX;
 #ifdef APACHE2
-	rv = apr_socket_create (sock, family, SOCK_STREAM, pool);
+	rv = apr_socket_create (sock, family, SOCK_STREAM, 0, pool);
 #else
 	(*sock)->fd = ap_psocket (pool, family, SOCK_STREAM, 0);
 	(*sock)->pool = pool;

